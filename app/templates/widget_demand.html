<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–í–∏–¥–∂–µ—Ç</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            padding: 10px 16px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            background: #fff;
        }
        .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #333;
        }
        .btn {
            background: #4caf50;
            color: #fff;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        .btn:hover { background: #43a047; }
    </style>
</head>
<body>
    <div class="container">
        <div class="info">
            <span>üìä</span>
            <span>–ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</span>
        </div>
        <button class="btn" onclick="openPopup()">–ó–∞–Ω–µ—Å—Ç–∏ —Ä–∞—Å—Ö–æ–¥—ã</button>
    </div>
    
    <script>
        var contextKey = new URLSearchParams(window.location.search).get('contextKey') || '';
        var messageId = 0;
        
        // –°–ª—É—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ú–æ–π–°–∫–ª–∞–¥
        window.addEventListener('message', function(event) {
            var data = event.data;
            console.log('MSG:', data);
            
            // –ö–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º Open - –æ—Ç–≤–µ—á–∞–µ–º OpenFeedback
            if (data && data.name === 'Open') {
                messageId = data.messageId || 0;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º OpenFeedback —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –≤–∏–¥–∂–µ—Ç
                window.parent.postMessage({
                    name: 'OpenFeedback',
                    messageId: messageId
                }, '*');
                
                console.log('Sent OpenFeedback');
            }
        });
        
        function openPopup() {
            console.log('Opening popup');
            window.parent.postMessage({
                name: 'OpenPopup',
                url: '/iframe?contextKey=' + encodeURIComponent(contextKey)
            }, '*');
        }
    </script>
</body>
</html>